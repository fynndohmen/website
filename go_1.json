[
{
  "title": "Turning an Old PC into a Go + PostgreSQL Cloud Lab",
  "content": [
    "This project is my first real step into the world of backend development, cloud-like setups, and databases using Go. I took an old i3 PC with 4GB RAM, installed Ubuntu Server on it, and turned it into a small home lab that exposes a JSON API built with Go and backed by a PostgreSQL database.",
    "The main goal was not just to get something working, but to really understand what each piece does: Linux as a server, PostgreSQL as a database server, Go as the HTTP backend, and how they all talk to each other over TCP, HTTP, and SQL."
  ],
  "images": [
    "go_projects_pics/server-ssh-setup.png",
    "go_projects_pics/psql-todos-table.png",
    "go_projects_pics/go-code-todos-handler.png",
    "go_projects_pics/todos-endpoint-browser.png"
  ],
  "description": [
    "### Goal & Overview",
    "- **Goal:** Turn an old PC into a small backend \"cloud lab\" with Go and PostgreSQL, and use it to learn how HTTP servers, databases, and contexts work together.",
    "- **Tech stack:**",
    "  - Ubuntu LTS on a repurposed i3 desktop as a headless server",
    "  - PostgreSQL as the database server",
    "  - Go (`net/http` + `database/sql` + `pgx` driver) as the HTTP API backend",
    "",
    "---",
    "### 1. Hardware & Linux Setup",
    "- I reused an old i3 PC with ~4GB RAM and installed **Ubuntu Server LTS** instead of a desktop environment.",
    "- The idea: keep it headless and manage everything over **SSH** from my main machine.",
    "- Steps:",
    "  - Create a bootable USB stick with the Ubuntu LTS ISO.",
    "  - Install Ubuntu with no GUI, only OpenSSH server enabled.",
    "  - Give the server a static IP or make sure I can consistently reach it via `ssh user@server-ip`.",
    "- Result: I can now power on the \"server PC\", and from my main computer connect only via SSH â€“ no screen, no keyboard needed on the server itself.",
    "",
    "---",
    "### 2. PostgreSQL as the Database Server",
    "- On the Ubuntu server, I installed PostgreSQL and created:",
    "  - a **user** (role) for my Go app,",
    "  - a **database** called `cloudlab`,",
    "  - and a **table** called `todos`.",
    "- The `todos` table structure:",
    "  ```sql",
    "  CREATE TABLE todos (",
    "      id SERIAL PRIMARY KEY,",
    "      title TEXT NOT NULL,",
    "      done BOOLEAN NOT NULL DEFAULT FALSE,",
    "      created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()",
    "  );",
    "  ```",
    "- I tested everything directly in `psql`:",
    "  - Inserted some rows like `('Cloud lernen')` and `('Go + PostgreSQL verbinden')`.",
    "  - Ran `SELECT * FROM todos;` to confirm the data model works.",
    "",
    "---",
    "### 3. Go Project Structure & Database Connection",
    "- On the Go side, I created a small `main.go` with:",
    "  - `package main` as the entry point.",
    "  - Imports for `net/http`, `database/sql`, `encoding/json`, `context`, `time`, and the `pgx` PostgreSQL driver:",
    "    ```go",
    "    import (",
    "        \"context\"",
    "        \"database/sql\"",
    "        \"encoding/json\"",
    "        \"log\"",
    "        \"net/http\"",
    "        \"time\"",
    "",
    "        _ \"github.com/jackc/pgx/v5/stdlib\"",
    "    )",
    "    ```",
    "- I defined a `Todo` struct that mirrors the database columns and controls the JSON field names:",
    "  ```go",
    "  type Todo struct {",
    "      ID        int       `json:\"id\"`",
    "      Title     string    `json:\"title\"`",
    "      Done      bool      `json:\"done\"`",
    "      CreatedAt time.Time `json:\"created_at\"`",
    "  }",
    "  ```",
    "- The database handle is a global `var db *sql.DB` representing a **connection pool**, not just one socket.",
    "",
    "---",
    "### 4. DSN, `sql.Open` and `db.Ping()`",
    "- To connect Go to PostgreSQL, I used a DSN (data source name) URL:",
    "  ```go",
    "  dsn := \"postgres://fynn:YOUR_PASSWORD@localhost:5432/cloudlab?sslmode=disable\"",
    "  ```",
    "- Then:",
    "  ```go",
    "  db, err = sql.Open(\"pgx\", dsn)",
    "  if err != nil {",
    "      log.Fatal(\"Error in sql.Open:\", err)",
    "  }",
    "",
    "  if err = db.Ping(); err != nil {",
    "      log.Fatal(\"Could not connect to database:\", err)",
    "  }",
    "  ```",
    "- `sql.Open` sets up the DB handle using the `pgx` driver, and `db.Ping()` actively checks that the PostgreSQL server is reachable and the credentials/DSN are correct.",
    "",
    "---",
    "### 5. HTTP Server, Routing and Handlers",
    "- For the HTTP side I used the standard library's `net/http` package.",
    "- I registered a handler for `/todos` like this:",
    "  ```go",
    "  http.HandleFunc(\"/todos\", getTodosHandler)",
    "  log.Println(\"Server running on :8080\")",
    "  log.Fatal(http.ListenAndServe(\":8080\", nil))",
    "  ```",
    "- `HandleFunc` registers `getTodosHandler` as the callback for incoming HTTP requests on the `/todos` path.",
    "- `ListenAndServe(\":8080\", nil)` starts the HTTP server and blocks, accepting connections and dispatching them to handlers.",
    "",
    "---",
    "### 6. Request Handling, Context and Database Query",
    "- The core of the API is the `getTodosHandler` function:",
    "  ```go",
    "  func getTodosHandler(w http.ResponseWriter, r *http.Request) {",
    "      ctx, cancel := context.WithTimeout(r.Context(), 5*time.Second)",
    "      defer cancel()",
    "",
    "      rows, err := db.QueryContext(ctx,",
    "          \"SELECT id, title, done, created_at FROM todos ORDER BY id\")",
    "      if err != nil {",
    "          http.Error(w, \"Database error\", http.StatusInternalServerError)",
    "          log.Println(\"Query error:\", err)",
    "          return",
    "      }",
    "      defer rows.Close()",
    "",
    "      var todos []Todo",
    "      for rows.Next() {",
    "          var t Todo",
    "          if err := rows.Scan(&t.ID, &t.Title, &t.Done, &t.CreatedAt); err != nil {",
    "              http.Error(w, \"Error reading data\", http.StatusInternalServerError)",
    "              log.Println(\"Scan error:\", err)",
    "              return",
    "          }",
    "          todos = append(todos, t)",
    "      }",
    "      if err := rows.Err(); err != nil {",
    "          http.Error(w, \"Error iterating over rows\", http.StatusInternalServerError)",
    "          log.Println(\"Rows error:\", err)",
    "          return",
    "      }",
    "",
    "      w.Header().Set(\"Content-Type\", \"application/json\")",
    "      if err := json.NewEncoder(w).Encode(todos); err != nil {",
    "          log.Println(\"JSON error:\", err)",
    "      }",
    "  }",
    "  ```",
    "- Key ideas I learned here:",
    "  - `w http.ResponseWriter` is how the server sends an HTTP response back to the client (status, headers, body).",
    "  - `r *http.Request` represents the incoming HTTP request from the browser (method, URL, headers, context, body).",
    "  - `context.WithTimeout` lets me limit how long the DB query is allowed to run (here: 5 seconds).",
    "  - `QueryContext` respects the context and will abort if the timeout is reached or the client disconnects.",
    "",
    "---",
    "### 7. JSON API Endpoint",
    "- At the end of the handler, I:",
    "  - set the `Content-Type` header to `application/json`,",
    "  - use `json.NewEncoder(w).Encode(todos)` to serialize the slice of `Todo` structs into JSON and stream it directly into the HTTP response.",
    "- A sample response from `GET /todos` looks like:",
    "  ```json",
    "  [",
    "    {",
    "      \"id\": 1,",
    "      \"title\": \"Cloud lernen\",",
    "      \"done\": false,",
    "      \"created_at\": \"2025-12-06T10:15:00Z\"",
    "    },",
    "    {",
    "      \"id\": 2,",
    "      \"title\": \"Go + PostgreSQL verbinden\",",
    "      \"done\": false,",
    "      \"created_at\": \"2025-12-06T10:20:00Z\"",
    "    }",
    "  ]",
    "  ```",
    "",
    "---",
    "### 8. Learning Takeaways",
    "- From this small project I learned:",
    "  - How to turn an old PC into a headless Ubuntu server and manage it via SSH.",
    "  - The difference between PostgreSQL as a **database server**, a **database** (e.g. `cloudlab`) and a **table** (e.g. `todos`).",
    "  - How Go's `database/sql` package uses a driver (`pgx`) and a DSN to connect to PostgreSQL.",
    "  - How HTTP handlers work in Go (`http.HandleFunc`, `ResponseWriter`, `*Request`).",
    "  - What a `context.Context` is, and how timeouts and cancellation signals flow through to database queries.",
    "  - How to stream query results into Go structs and return them as clean JSON to a browser or API client.",
    "",
    "- This is just the starting point. From here I can extend the API with `POST /todos`, authentication, more tables, or even deploy a similar Go + PostgreSQL setup on a real cloud provider later."
  ],
  "date": "2025-12-06"
}
]
